package tests;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.Matchers;
import org.mockito.Mockito;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

import editor.Recorder;
import engine.EditionEngine;
import engine.ImplementedEngine;
import engine.Selection;
import recordables.CopyRecordable;
import recordables.CutRecordable;
import recordables.DelTextRecordable;
import recordables.InsTextRecordable;
import recordables.PasteRecordable;
import recordables.SelectRecordable;

@RunWith(PowerMockRunner.class)
@PrepareForTest({ ImplementedEngine.class, Recorder.class })
public class UnitTestCommandsV2 {

	private static EditionEngine	engine;
	private static Recorder			recorder;

	public UnitTestCommandsV2() {

		engine = PowerMockito.mock(ImplementedEngine.class);
		recorder = PowerMockito.mock(Recorder.class);
	}

	@Test
	public void testCopyRecordable() {

		CopyRecordable cmd = new CopyRecordable(engine, recorder);
		cmd.executer();
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

	@Test
	public void testCouperRecordable() {

		CutRecordable cmd = new CutRecordable(engine, recorder);
		cmd.executer();
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

	@Test
	public void testDelTextRecordable() {

		DelTextRecordable cmd = new DelTextRecordable(engine, recorder);
		cmd.executer();
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

	@Test
	public void testInsererTexteRecordable() {

		InsTextRecordable cmd = new InsTextRecordable(engine, recorder, "Test");
		cmd.execute();
		Mockito.verify(engine).insererTexte(Matchers.eq("Test"));
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

	@Test
	public void testPasteRecordable() {

		PasteRecordable cmd = new PasteRecordable(engine, recorder);
		cmd.execute();
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

	@Test
	public void testSelectRecordable() {

		SelectRecordable cmd = new SelectRecordable(engine, recorder, new Selection(0, 4));
		cmd.execute();
		Mockito.verify(recorder).enregistrer(Matchers.eq(cmd));
	}

}
